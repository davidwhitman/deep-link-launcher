dependencies:
  pre:
    - cp -r "ci/licenses/" "/usr/local/android-sdk-linux/"
  cache_directories:
    - ~/.android

test:
  override:
    # Runner 1
    # Run unit tests
    # Copy the test results to the test results dir

    # Runner 2
    # Build debug apk.
    # Copy apk file to CircleCI artifacts dir

    - case $CIRCLE_NODE_INDEX in 0) ./gradlew testDebugUnitTest ;; 1) ./gradlew assembleDebug ;; esac:
        parallel: true

    - case $CIRCLE_NODE_INDEX in 0) cp -r app/build/test-results/testDebugUnitTest/* $CIRCLE_TEST_REPORTS ;; 1)cp -r app/build/outputs $CIRCLE_ARTIFACTS ;; esac:
        parallel: true